<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turta Yakalama Oyunu</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #2d2d2d;
            height: 100vh;
        }
        /* Mobilde taşmayı önlemek için canvas ayarı */
        canvas {
            box-shadow: 0px 0px 20px rgba(0,0,0,0.5);
            border-radius: 10px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>

<script>
// OYUN AYARLARI
const config = {
    type: Phaser.AUTO,
    width: 360, // Mobil dikey ekran genişliği
    height: 640, // Mobil dikey ekran yüksekliği
    backgroundColor: '#87CEEB', // Gökyüzü mavisi arka plan (geçici)
    physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 0 }, // Dünyanın genel yerçekimi (biz turtalara özel ekleyeceğiz)
            debug: false
        }
    },
    scene: {
        preload: preload,
        create: create,
        update: update
    }
};

// Değişkenler
let player;
let cursors;
let pies; // Turtalar grubu
let score = 0;
let scoreText;
let ground;

const game = new Phaser.Game(config);

// --- 1. BÖLÜM: PRELOAD (Resimlerin Yüklendiği Yer) ---
function preload ()
{
    // Kendi resimlerini yüklüyorsun
    this.load.image('karakter_resmi', 'assets/karakter.png');
    this.load.image('turta_resmi', 'assets/turta.png');
    this.load.image('zemin_resmi', 'assets/zemin.png');
    // this.load.image('arkaplan_resmi', 'assets/arkaplan.png'); // Arkaplanı sonra ekleyebilirsin
}

// --- 2. BÖLÜM: CREATE (Oyun Nesnelerinin Oluşturulduğu Yer) ---
function create ()
{
    // 1. Arkaplan (Resim ekleyince burayı açarsın)
    // this.add.image(180, 320, 'arkaplan');

    // 2. Zemin (Platform)
    ground = this.physics.add.staticGroup();
    // Zemin resmini ekranın altına yerleştir (360 genişlik, 640 yükseklik demiştik)
    ground.create(180, 620, 'placeholder_ground').setScale(1).refreshBody();

    // 3. Karakter
    // Karakteri zeminin hemen üstünde oluşturuyoruz
    player = this.physics.add.sprite(180, 550, 'placeholder_char');
    
    // Karakterin oyun alanından dışarı çıkmasını engelle
    player.setCollideWorldBounds(true);
    // Karakterin zeminle çarpışmasını sağla (düşmemesi için)
    this.physics.add.collider(player, ground);

    // 4. Turtalar Grubu
    pies = this.physics.add.group();

    // Her 1 saniyede (1000ms) bir yeni turta düşür
    this.time.addEvent({
        delay: 1000, 
        callback: spawnPie,
        callbackScope: this,
        loop: true
    });

    // 5. Kontroller (Klavye ok tuşları)
    cursors = this.input.keyboard.createCursorKeys();

    // 6. Skor Metni (Sol üst köşe)
    scoreText = this.add.text(16, 16, 'SCORE: 0', { fontSize: '32px', fill: '#000', fontStyle: 'bold' });

    // 7. Çarpışma (Yakalama) Mantığı
    // Karakter ile turtalar örtüşürse 'collectPie' fonksiyonunu çalıştır
    this.physics.add.overlap(player, pies, collectPie, null, this);
}

// --- 3. BÖLÜM: UPDATE (Oyun Döngüsü - Her an çalışan kısım) ---
function update ()
{
    // Karakter Hareketi (Sadece sağ sol)
    if (cursors.left.isDown)
    {
        player.setVelocityX(-200); // Sola git
    }
    else if (cursors.right.isDown)
    {
        player.setVelocityX(200); // Sağa git
    }
    else
    {
        player.setVelocityX(0); // Tuşa basılmıyorsa dur
    }

    // Ekrandan çıkan turtaları temizle (Performans için önemli)
    pies.children.iterate(function (pie) {
        if (pie && pie.y > 650) {
            pie.destroy();
            // İstersen burada can azaltma ekleyebilirsin
        }
    });
}

// --- YARDIMCI FONKSİYONLAR ---

// Turta Oluşturma Fonksiyonu
function spawnPie () {
    // Rastgele bir X pozisyonu belirle (ekran genişliği içinde)
    const x = Phaser.Math.Between(30, 330);
    // Ekranın en tepesinden (y=-50) başlat
    const pie = pies.create(x, -50, 'placeholder_pie');
    
    // Düşüş hızı ver (yerçekimi gibi)
    pie.setVelocityY(Phaser.Math.Between(150, 250)); 
}

// Turta Yakalama Fonksiyonu
function collectPie (player, pie)
{
    pie.disableBody(true, true); // Turtayı yok et

    score += 10; // Skoru artır
    scoreText.setText('SCORE: ' + score); // Skor yazısını güncelle
}

</script>

</body>
</html>